MERGE INTO  t
USING (select t1.s_no, t1.s_name
         from  t1
         left join  t2
           on t2.s_no = t1.s_no) tw
ON (t.s_no = tw.s_no)
WHEN MATCHED THEN
  UPDATE SET t.t_no = tw.t_no
WHEN NOT MATCHED THEN
  INSERT
  VALUES
    (tw.s_no, tw.s_name);
MERGE INTO  tb1
USING (select tb2.s_no, tb2.s_name
         from  tb2
         left join  tb3
           on tb2.s_no = tb3.s_no) tw
ON (tb1.s_no = tw.s_no)
WHEN MATCHED THEN
  UPDATE SET tb1.t_no = tw.t_no
WHEN NOT MATCHED THEN
  INSERT
  VALUES
    (tw.s_no, tw.s_name);
